<% content_for :body_id, 'organizer-event-dashboard' %>
<% content_for :body_class, 'organizer-event' %>
<%= render partial: "partials/manage_nav" %>

<style media="screen">
  .dashboard {
    min-height: 120px;
    padding-top: 20px;
    padding-left: 20px;
    padding-right: 20px;
  }
  .copy-link {
    padding: 10px;
  }
  .widget {
    background: #fff;
    margin-top: 30px;
  }
  .widget p {
    text-align: center;
    padding: 0px;
    margin: 0px;
  }
  .progress {
    height: 5px;
    margin-top: 10px;
    margin-bottom: 5px;
  }
  .progress .progress-bar {
    background-color: #17A41D;
  }
</style>
<div class="section" id="dashboard-show-section" style="min-height: 240px; background: #F3F3F3;">
  <div class="container">
    <div class="section-header row">
      <div class="col-xs-12">
        <div class="row">
          <div class="col-xs-12 col-md-4">
            <div class="widget dashboard">
              <p style="font-size: 30pt; text-transform: uppercase; color: #17A41D;"><%= convert_to_currency(@total_sales) %></p>
              <p style="font-size: 14pt; text-transform: uppercase;">Total sales</p>
            </div>
          </div>
          <div class="col-xs-12 col-md-4">
            <div class="widget dashboard">
              <div class="number" style="margin-top: 15px">
                <div style="display: inline-block; width: 50%; float: left"><%= '%.2f' % @percentage %>%</div>
                <div style="display: inline-block; width: 50%; text-align: right;"><%= @paid %> / <%= @total %></div>
              </div>
              <div class="progress">
                <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: <%= @percentage %>%;">
                  <span class="sr-only">0.0% Complete</span>
                </div>
              </div>
              <p style="font-size: 14pt; text-transform: uppercase;">Tickets sold</p>
            </div>
          </div>
          <div class="col-xs-12 col-md-4">
            <div class="widget dashboard">
              <% if @live %>
                <p style="font-size: 30pt; text-transform: uppercase; color: #000;">
                  <%= @days_to_go %>
                </p>
                <p style="font-size: 14pt; text-transform: uppercase;">Days to go</p>
              <% else %>
                <p style="font-size: 30pt; text-transform: uppercase; color: #17A41D;">
                  <%= convert_to_currency(@total_sales) %>
                </p>
                <p style="font-size: 14pt; text-transform: uppercase;">Transferable in 7 Days</p>
              <% end %>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <div class="widget copy-link">
              <div class="row">
                <div class="col-xs-12">
                  <div id="copy-link" class="btn btn-thekanko-copy col-xs-12 col-sm-3 col-md-2 col-lg-2" data-clipboard-target="#copy-target"><i class="nc-icon-outline ui-2_link-72"></i> COPY URL</div>
                  <div id="copy-target" class="col-xs-12 col-sm-9 col-md-10 col-lg-10" style="display: inline-block; padding-left: 20px; line-height: 33px;"><%= "#{App.domain}#{client_event_path(@event)}" %></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="section" id="order-list-section">
  <div class="container">
    <div class="section-body row">
      <div class="col-xs-12">
        <div class="event-section-panel">
          <div class="row panel-header">
            <div class="col-xs-12">
              <h2 style="margin-top: 0px;">RECENT ORDERS</h2>
            </div>
          </div>
          <% if @orders.present? %>
            <div class="table-responsive organizer-table">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <td>ORDER #</td>
                    <td>ORDER DATE</td>
                    <td>TICKET BUYER</td>
                    <td>QUANTITY</td>
                    <td>PRICE</td>
                    <td>PAYMENT</td>
                    <td>STATUS</td>
                  </tr>
                </thead>
                <tbody>
                  <% @orders.each do |order| %>
                  <tr>
                    <td><%= link_to "##{order.code}", orders_detail_organizer_event_path(id: @event.slug, code: order.code) %></td>
                    <td><%= order.created_at.strftime("%d %B %Y, %H:%M") %></td>
                    <td><%= order.user.first_name %> <%= order.user.last_name %></td>
                    <td><%= order.tickets.count %></td>
                    <td><%= convert_to_currency(order.to_price) %></td>
                    <td>
                      <% if !order.payment.nil? %>
                        <%= order.payment.channel %>
                      <% end %>
                    </td>
                    <td>
                      <span class="order-status <%= order.status %>"><%= order.status %></span>
                    </td>
                  </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          <% else %>
            <div class="row">
              <div class="col-xs-12 text-center" style="background: #fff; color: #ccc">
                <p>
                  <i class="nc-icon-outline media-1_ticket-75" style="font-size: 100px;transform: rotate(-30deg);"></i>
                </p>
                <p>&nbsp;</p>
                <p>
                  Don't have any orders yet.
                </p>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function(){
    new Clipboard('#copy-link');
  });
</script>
